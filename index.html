<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="color-scheme" content="dark light">
  <title>VulSilverFox Followers</title>

  <style>
    :root {
      --hue: 120;
      --glow: hsl(var(--hue), 100%, 50%);
      --bgLightness: 0%;
    }

    html, body {
      margin: 0;
      background: hsl(0, 0%, var(--bgLightness));
      font-family: 'Orbitron', sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      width: 100vw;
      height: 100vh;
      color: var(--glow);
      gap: 20px;
      overflow: hidden;
      position: relative;
    }

    * {
      transition:
        color 0.3s linear,
        border-color 0.3s linear,
        box-shadow 0.3s linear,
        text-shadow 0.3s linear,
        filter 0.3s linear,
        background 0.3s linear,
        opacity 0.3s ease,
        transform 0.2s ease-out;
    }

    /* GLOBAL SCANLINES */
    body::after {
      content: "";
      position: fixed;
      inset: 0;
      pointer-events: none;
      background: repeating-linear-gradient(
        to bottom,
        rgba(255,255,255,0.03) 0px,
        rgba(255,255,255,0.03) 2px,
        transparent 4px
      );
      opacity: 0.4;
      z-index: 2;
    }

    /* NEON RADIAL GLOW BEHIND WIDGET */
    body::before {
      content: "";
      position: absolute;
      width: 60vw;
      height: 60vw;
      background: radial-gradient(circle, var(--glow) 0%, transparent 70%);
      opacity: 0.15;
      filter: blur(80px);
      z-index: 0;
    }

    /* BACKGROUND LAYERS */
    .bg-layer {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 1;
      opacity: 0;
    }

    .bg-layer.active {
      opacity: 1;
    }

    /* PARTICLE FIELD */
    .bg-particles {
      background: radial-gradient(circle at 10% 20%, rgba(255,255,255,0.15) 0, transparent 40%),
                  radial-gradient(circle at 80% 30%, rgba(255,255,255,0.12) 0, transparent 45%),
                  radial-gradient(circle at 30% 80%, rgba(255,255,255,0.1) 0, transparent 40%);
      animation: particlesMove 20s linear infinite alternate;
      mix-blend-mode: screen;
    }

    @keyframes particlesMove {
      0% { transform: translate3d(0,0,0); }
      50% { transform: translate3d(-20px, 10px, 0); }
      100% { transform: translate3d(20px, -10px, 0); }
    }

    /* GRID FLOOR */
    .bg-grid {
      background:
        linear-gradient(rgba(255,255,255,0.15) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255,255,255,0.15) 1px, transparent 1px);
      background-size: 40px 40px;
      transform-origin: center bottom;
      transform: perspective(600px) rotateX(70deg) translateY(20%);
      opacity: 0;
      mix-blend-mode: screen;
      animation: gridGlow 4s ease-in-out infinite alternate;
    }

    @keyframes gridGlow {
      0% { opacity: 0.15; }
      100% { opacity: 0.35; }
    }

    /* AURORA WAVE */
    .bg-aurora {
      background: radial-gradient(circle at 10% 0%, hsla(var(--hue), 100%, 60%, 0.4), transparent 55%),
                  radial-gradient(circle at 90% 100%, hsla(calc(var(--hue) + 80), 100%, 60%, 0.35), transparent 55%);
      animation: auroraMove 18s ease-in-out infinite alternate;
      mix-blend-mode: screen;
    }

    @keyframes auroraMove {
      0% { transform: translate3d(0,0,0); }
      50% { transform: translate3d(-40px, 20px, 0); }
      100% { transform: translate3d(40px, -20px, 0); }
    }

    /* CONTROLS PANEL */
    .controls-panel {
      position: fixed;
      top: 50%;
      right: 0;
      transform: translateY(-50%) translateX(100%);
      width: 260px;
      background: rgba(0,0,0,0.85);
      border-left: 2px solid var(--glow);
      box-shadow: 0 0 20px var(--glow);
      padding: 15px 15px 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      z-index: 30;
      color: #fff;
    }

    body.settings-open .controls-panel {
      transform: translateY(-50%) translateX(0);
    }

    .controls-panel h2 {
      margin: 0 0 5px;
      font-size: 16px;
      text-shadow: 0 0 10px var(--glow);
    }

    .controls-panel h3 {
      margin: 8px 0 4px;
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 1px;
      opacity: 0.8;
    }

    .controls-panel label {
      font-size: 12px;
      display: flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
    }

    .controls-panel input[type="checkbox"] {
      accent-color: #0ff;
      cursor: pointer;
    }

    .controls-panel .guide {
      font-size: 11px;
      line-height: 1.3;
      margin-top: 6px;
      border-top: 1px solid rgba(255,255,255,0.1);
      padding-top: 6px;
      opacity: 0.9;
    }

    .controls-panel .guide ul {
      padding-left: 16px;
      margin: 4px 0 0;
    }

    .controls-panel .guide li {
      margin-bottom: 2px;
    }

    .slider-row {
      display: flex;
      flex-direction: column;
      gap: 4px;
      margin-bottom: 4px;
    }

    .slider-row span {
      font-size: 11px;
      opacity: 0.8;
    }

    /* HIDE UI MODE (smooth fade) */
    body.hide-ui .controls-panel,
    body.hide-ui .timebox {
      opacity: 0;
      pointer-events: none;
    }

    /* GEAR BUTTON */
    .gear {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: 2px solid var(--glow);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      color: var(--glow);
      box-shadow: 0 0 15px var(--glow);
      cursor: pointer;
      background: rgba(0,0,0,0.7);
      z-index: 40;
      text-shadow: 0 0 10px var(--glow);
    }

    .gear:hover {
      transform: scale(1.1) rotate(10deg);
    }

    /* SLIDERS */
    #colorSlider, #bgSlider {
      width: 100%;
      height: 10px;
      border: 2px solid var(--glow);
      border-radius: 10px;
      box-shadow: 0 0 10px var(--glow);
      cursor: pointer;
      appearance: none;
    }

    #colorSlider {
      background: linear-gradient(
        to right,
        hsl(0,100%,50%),
        hsl(60,100%,50%),
        hsl(120,100%,50%),
        hsl(180,100%,50%),
        hsl(240,100%,50%),
        hsl(300,100%,50%),
        hsl(360,100%,50%)
      );
    }

    #bgSlider {
      background: linear-gradient(
        to right,
        hsl(0,0%,0%),
        hsl(0,0%,100%)
      );
    }

    #colorSlider::-webkit-slider-thumb,
    #bgSlider::-webkit-slider-thumb {
      appearance: none;
      width: 16px;
      height: 16px;
      background: var(--glow);
      border-radius: 50%;
      box-shadow: 0 0 10px var(--glow);
      cursor: pointer;
    }

    /* WIDGET */
    .widget {
      position: relative;
      overflow: hidden;
      display: flex;
      align-items: center;
      gap: 2vw;
      padding: 1.5vw 3vw;
      border: 0.3vw solid var(--glow);
      border-radius: 1vw;
      background: hsl(0, 0%, var(--bgLightness));
      box-shadow: 0 0 2vw var(--glow);
      animation: pulse 2s infinite, borderFlow 4s linear infinite;
      cursor: pointer;
      transform-style: preserve-3d;
      z-index: 10;
    }

    /* GLASS MODE */
    .glass {
      backdrop-filter: blur(14px);
      background: rgba(255,255,255,0.12) !important;
      box-shadow: 0 0 30px rgba(255,255,255,0.4);
    }

    /* CIRCUIT MODE */
    .circuit {
      background-image:
        linear-gradient(90deg, rgba(255,255,255,0.08) 1px, transparent 1px),
        linear-gradient(rgba(255,255,255,0.08) 1px, transparent 1px);
      background-size: 20px 20px;
      background-blend-mode: screen;
    }

    /* BORDER FLOW ANIMATION */
    @keyframes borderFlow {
      0% { border-color: hsl(var(--hue), 100%, 50%); }
      50% { border-color: hsl(calc(var(--hue) + 60), 100%, 50%); }
      100% { border-color: hsl(var(--hue), 100%, 50%); }
    }

    /* GLITCH */
    .widget::after {
      content: "";
      position: absolute;
      inset: 0;
      pointer-events: none;
      opacity: 0.6;
      background: hsla(var(--hue), 100%, 50%, 0.15);
      animation: glitch 1.4s steps(2, end) infinite;
      z-index: 3;
    }

    .scanlayer {
      position: absolute;
      inset: 0;
      pointer-events: none;
      background: repeating-linear-gradient(
        to bottom,
        hsla(var(--hue), 100%, 50%, 0.15) 0px,
        hsla(var(--hue), 100%, 50%, 0.15) 6px,
        hsla(var(--hue), 100%, 50%, 0.00) 12px
      );
      animation: scanMove 4s linear infinite;
      opacity: 0.6;
      z-index: 2;
    }

    @keyframes scanMove {
      0% { transform: translateY(0); }
      100% { transform: translateY(12px); }
    }

    @keyframes glitch {
      0% { transform: translateX(0); opacity: 0.6; }
      10% { transform: translateX(-2px); opacity: 0.75; }
      20% { transform: translateX(2px); opacity: 0.5; }
      30% { transform: translateX(-1px); opacity: 0.7; }
      40% { transform: translateX(1px); opacity: 0.55; }
      50% { transform: translateX(0); opacity: 0.6; }
      100% { transform: translateX(0); opacity: 0.6; }
    }

    @keyframes pulse {
      0% { box-shadow: 0 0 1vw var(--glow); }
      50% { box-shadow: 0 0 2.2vw var(--glow); }
      100% { box-shadow: 0 0 1vw var(--glow); }
    }

    /* POP ANIMATION */
    @keyframes pop {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }

    .pop {
      animation: pop 0.4s ease-out;
    }

    /* EVENT FX */
    @keyframes shockwave {
      0% { box-shadow: 0 0 0 0 rgba(255,255,255,0.7); }
      100% { box-shadow: 0 0 40px 25px rgba(255,255,255,0); }
    }

    .shockwave {
      animation: shockwave 0.6s ease-out;
    }

    @keyframes flash {
      0% { background-color: rgba(255,255,255,0.6); }
      100% { background-color: transparent; }
    }

    .flash-overlay {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 50;
      animation: flash 0.3s ease-out;
    }

    /* ICON + TEXT */
    .icon {
      width: 6vw;
      height: 6vw;
      max-width: 80px;
      max-height: 80px;
      filter: drop-shadow(0 0 1vw var(--glow));
      z-index: 5;
      cursor: pointer;
    }

    .count {
      font-size: 3vw;
      text-shadow: 0 0 1vw var(--glow);
      white-space: nowrap;
      z-index: 5;
    }

    .timebox {
      font-size: 1.8vw;
      text-shadow: 0 0 1vw var(--glow);
      border: 0.2vw solid var(--glow);
      padding: 10px 20px;
      border-radius: 10px;
      box-shadow: 0 0 1.5vw var(--glow);
      z-index: 5;
    }

    /* RAINBOW PAGE MODE */
    body.rainbow-page {
      animation: rainbowPage 8s linear infinite;
    }

    @keyframes rainbowPage {
      0%   { --hue: 0; }
      16%  { --hue: 60; }
      32%  { --hue: 120; }
      48%  { --hue: 180; }
      64%  { --hue: 240; }
      80%  { --hue: 300; }
      100% { --hue: 360; }
    }

    /* HOLOGRAM DISTORTION MODE */
    body.holo-on {
      filter: contrast(1.05) saturate(1.1);
    }

    body.holo-on .widget {
      filter: drop-shadow(0 0 10px rgba(0,255,255,0.7));
    }

    /* NEON CURSOR */
    #neonCursor {
      position: fixed;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: var(--glow);
      box-shadow: 0 0 15px var(--glow);
      pointer-events: none;
      z-index: 60;
      transform: translate(-50%, -50%);
      opacity: 0;
    }

    body.neon-cursor-on #neonCursor {
      opacity: 1;
    }

  </style>
</head>

<body>

  <!-- BACKGROUND LAYERS -->
  <div class="bg-layer bg-particles" id="bgParticles"></div>
  <div class="bg-layer bg-grid" id="bgGrid"></div>
  <div class="bg-layer bg-aurora" id="bgAurora"></div>

  <!-- NEON CURSOR -->
  <div id="neonCursor"></div>

  <!-- MAIN WIDGET -->
  <div class="widget" id="widget">
    <div class="scanlayer"></div>
    <img class="icon" id="wolfIcon" src="wolf.png" alt="wolf icon">
    <div class="count">Followers: <span id="num">...</span></div>
  </div>

  <div class="timebox" id="timebox">Loading time...</div>

  <!-- CONTROL PANEL (SLIDERS + TOGGLES + GUIDE) -->
  <div class="controls-panel" id="controlsPanel">
    <h2>VulSilverFox Control Hub</h2>

    <h3>Sliders</h3>
    <div class="slider-row">
      <span>Hue</span>
      <input type="range" id="colorSlider" min="0" max="360" value="120">
    </div>
    <div class="slider-row">
      <span>Background (Black ↔ White)</span>
      <input type="range" id="bgSlider" min="0" max="100" value="0">
    </div>

    <h3>Visual Modes</h3>
    <label><input type="checkbox" id="chkGlass"> Glass mode (G)</label>
    <label><input type="checkbox" id="chkCircuit"> Circuit mode (C)</label>
    <label><input type="checkbox" id="chkRainbowPage"> Full-page rainbow (R)</label>
    <label><input type="checkbox" id="chkHolo"> Hologram distortion (D)</label>
    <label><input type="checkbox" id="chkParticles"> Particle field (P)</label>
    <label><input type="checkbox" id="chkGrid"> Grid floor (F)</label>
    <label><input type="checkbox" id="chkAurora"> Aurora waves (A)</label>
    <label><input type="checkbox" id="chkNeonCursor"> Neon cursor (N)</label>

    <h3>Presets</h3>
    <label>Cold mode (8)</label>
    <label>Warm mode (9)</label>
    <label>Default reset (0)</label>

    <h3>Guide</h3>
    <div class="guide">
      <ul>
        <li><b>Gear</b>: open/close this panel</li>
        <li><b>H</b>: hide/show UI (panel + time)</li>
        <li><b>G</b>: toggle glass mode</li>
        <li><b>C</b>: toggle circuit mode</li>
        <li><b>R</b>: full-page rainbow cycle</li>
        <li><b>D</b>: hologram distortion</li>
        <li><b>P</b>: particle background</li>
        <li><b>F</b>: grid floor background</li>
        <li><b>A</b>: aurora background</li>
        <li><b>N</b>: neon cursor</li>
        <li><b>1/2/3</b>: hue presets</li>
        <li><b>8</b>: cold theme, <b>9</b>: warm theme</li>
        <li><b>0</b>: reset theme</li>
        <li><b>X</b>: shockwave on widget</li>
        <li><b>Z</b>: screen flash</li>
        <li><b>Click wolf</b>: widget rainbow mode</li>
      </ul>
    </div>
  </div>

  <!-- GEAR BUTTON -->
  <div class="gear" id="gear">⚙</div>

  <script>
    async function loadCount() {
      const res = await fetch("https://decapi.me/twitch/followcount/vulsilverfox");
      const text = await res.text();
      document.getElementById("num").textContent = text;
    }

    loadCount();
    setInterval(loadCount, 30000);

    function updateClock() {
      const now = new Date();
      const est = new Date(now.toLocaleString("en-US", { timeZone: "America/New_York" }));

      const time = est.toLocaleTimeString("en-US", {
        hour: "2-digit",
        minute: "2-digit",
        second: "2-digit"
      });

      const date = est.toLocaleDateString("en-US", {
        weekday: "long",
        month: "long",
        day: "numeric",
        year: "numeric"
      });

      document.getElementById("timebox").textContent = `${date} — ${time} EST`;
    }

    updateClock();
    setInterval(updateClock, 1000);

    const root = document.documentElement;
    const widget = document.getElementById("widget");
    const gear = document.getElementById("gear");
    const neonCursor = document.getElementById("neonCursor");

    const chkGlass = document.getElementById("chkGlass");
    const chkCircuit = document.getElementById("chkCircuit");
    const chkRainbowPage = document.getElementById("chkRainbowPage");
    const chkHolo = document.getElementById("chkHolo");
    const chkParticles = document.getElementById("chkParticles");
    const chkGrid = document.getElementById("chkGrid");
    const chkAurora = document.getElementById("chkAurora");
    const chkNeonCursor = document.getElementById("chkNeonCursor");

    const bgParticles = document.getElementById("bgParticles");
    const bgGrid = document.getElementById("bgGrid");
    const bgAurora = document.getElementById("bgAurora");

    const colorSlider = document.getElementById("colorSlider");
    const bgSlider = document.getElementById("bgSlider");

    /* COLOR SLIDER */
    colorSlider.addEventListener("input", (e) => {
      widget.classList.remove("rainbow-mode");
      const hue = e.target.value;
      root.style.setProperty("--hue", hue);
      root.style.setProperty("--glow", `hsl(${hue}, 100%, 50%)`);
      saveState();
    });

    /* BACKGROUND SLIDER */
    bgSlider.addEventListener("input", (e) => {
      const lightness = e.target.value;
      root.style.setProperty("--bgLightness", lightness + "%");
      saveState();
    });

    /* RAINBOW MODE TOGGLE (widget only) */
    let rainbowOn = false;
    document.getElementById("wolfIcon").addEventListener("click", () => {
      rainbowOn = !rainbowOn;
      widget.classList.toggle("rainbow-mode", rainbowOn);
    });

    /* 3D PARALLAX */
    widget.addEventListener("mousemove", (e) => {
      const rect = widget.getBoundingClientRect();
      const x = (e.clientX - rect.left) / rect.width - 0.5;
      const y = (e.clientY - rect.top) / rect.height - 0.5;
      widget.style.transform = `rotateX(${y * 6}deg) rotateY(${x * 6}deg)`;
    });

    widget.addEventListener("mouseleave", () => {
      widget.style.transform = "rotateX(0deg) rotateY(0deg)";
    });

    /* GEAR TOGGLE FOR PANEL */
    gear.addEventListener("click", () => {
      document.body.classList.toggle("settings-open");
    });

    /* HIDE UI (H) */
    document.addEventListener("keydown", (e) => {
      if (e.key.toLowerCase() === "h") {
        document.body.classList.toggle("hide-ui");
      }
    });

    /* GLASS MODE (G) */
    function toggleGlass() {
      widget.classList.toggle("glass");
      chkGlass.checked = widget.classList.contains("glass");
      saveState();
    }

    /* CIRCUIT MODE (C) */
    function toggleCircuit() {
      widget.classList.toggle("circuit");
      chkCircuit.checked = widget.classList.contains("circuit");
      saveState();
    }

    /* RAINBOW PAGE (R) */
    function toggleRainbowPage() {
      document.body.classList.toggle("rainbow-page");
      chkRainbowPage.checked = document.body.classList.contains("rainbow-page");
      saveState();
    }

    /* HOLOGRAM (D) */
    function toggleHolo() {
      document.body.classList.toggle("holo-on");
      chkHolo.checked = document.body.classList.contains("holo-on");
      saveState();
    }

    /* PARTICLES (P) */
    function toggleParticles() {
      bgParticles.classList.toggle("active");
      chkParticles.checked = bgParticles.classList.contains("active");
      saveState();
    }

    /* GRID (F) */
    function toggleGrid() {
      bgGrid.classList.toggle("active");
      chkGrid.checked = bgGrid.classList.contains("active");
      saveState();
    }

    /* AURORA (A) */
    function toggleAurora() {
      bgAurora.classList.toggle("active");
      chkAurora.checked = bgAurora.classList.contains("active");
      saveState();
    }

    /* NEON CURSOR (N) */
    function toggleNeonCursor() {
      document.body.classList.toggle("neon-cursor-on");
      chkNeonCursor.checked = document.body.classList.contains("neon-cursor-on");
      saveState();
    }

    /* CHECKBOX SYNC */
    chkGlass.addEventListener("change", toggleGlass);
    chkCircuit.addEventListener("change", toggleCircuit);
    chkRainbowPage.addEventListener("change", toggleRainbowPage);
    chkHolo.addEventListener("change", toggleHolo);
    chkParticles.addEventListener("change", toggleParticles);
    chkGrid.addEventListener("change", toggleGrid);
    chkAurora.addEventListener("change", toggleAurora);
    chkNeonCursor.addEventListener("change", toggleNeonCursor);

    /* KEYBOARD SHORTCUTS */
    document.addEventListener("keydown", (e) => {
      const key = e.key.toLowerCase();

      if (key === "g") toggleGlass();
      if (key === "c") toggleCircuit();
      if (key === "r") toggleRainbowPage();
      if (key === "d") toggleHolo();
      if (key === "p") toggleParticles();
      if (key === "f") toggleGrid();
      if (key === "a") toggleAurora();
      if (key === "n") toggleNeonCursor();

      /* THEME PRESETS */
      if (e.key === "1") {
        root.style.setProperty("--hue", 200);
        root.style.setProperty("--glow", `hsl(200, 100%, 50%)`);
        colorSlider.value = 200;
        saveState();
      }
      if (e.key === "2") {
        root.style.setProperty("--hue", 120);
        root.style.setProperty("--glow", `hsl(120, 100%, 50%)`);
        colorSlider.value = 120;
        saveState();
      }
      if (e.key === "3") {
        root.style.setProperty("--hue", 300);
        root.style.setProperty("--glow", `hsl(300, 100%, 50%)`);
        colorSlider.value = 300;
        saveState();
      }

      /* COLD MODE (8) */
      if (e.key === "8") {
        root.style.setProperty("--hue", 200);
        root.style.setProperty("--glow", `hsl(200, 100%, 60%)`);
        colorSlider.value = 200;
        bgSlider.value = 10;
        root.style.setProperty("--bgLightness", "10%");
        widget.classList.add("glass");
        chkGlass.checked = true;
        saveState();
      }

      /* WARM MODE (9) */
      if (e.key === "9") {
        root.style.setProperty("--hue", 30);
        root.style.setProperty("--glow", `hsl(30, 100%, 55%)`);
        colorSlider.value = 30;
        bgSlider.value = 5;
        root.style.setProperty("--bgLightness", "5%");
        widget.classList.remove("glass");
        chkGlass.checked = false;
        saveState();
      }

      /* RESET (0) */
      if (e.key === "0") {
        root.style.setProperty("--hue", 120);
        root.style.setProperty("--glow", `hsl(120, 100%, 50%)`);
        colorSlider.value = 120;
        bgSlider.value = 0;
        root.style.setProperty("--bgLightness", "0%");
        widget.classList.remove("glass", "circuit");
        document.body.classList.remove("rainbow-page", "holo-on", "neon-cursor-on");
        bgParticles.classList.remove("active");
        bgGrid.classList.remove("active");
        bgAurora.classList.remove("active");
        chkGlass.checked = false;
        chkCircuit.checked = false;
        chkRainbowPage.checked = false;
        chkHolo.checked = false;
        chkParticles.checked = false;
        chkGrid.checked = false;
        chkAurora.checked = false;
        chkNeonCursor.checked = false;
        saveState();
      }

      /* EVENT FX */
      if (key === "x") {
        widget.classList.add("shockwave");
        setTimeout(() => widget.classList.remove("shockwave"), 600);
      }

      if (key === "z") {
        const flash = document.createElement("div");
        flash.className = "flash-overlay";
        document.body.appendChild(flash);
        setTimeout(() => flash.remove(), 300);
      }
    });

    /* NEON CURSOR FOLLOW */
    document.addEventListener("mousemove", (e) => {
      neonCursor.style.left = e.clientX + "px";
      neonCursor.style.top = e.clientY + "px";
    });

    /* STATE PERSISTENCE */
    function saveState() {
      const state = {
        hue: getComputedStyle(root).getPropertyValue("--hue").trim(),
        bgLightness: getComputedStyle(root).getPropertyValue("--bgLightness").trim(),
        glass: widget.classList.contains("glass"),
        circuit: widget.classList.contains("circuit"),
        rainbowPage: document.body.classList.contains("rainbow-page"),
        holo: document.body.classList.contains("holo-on"),
        particles: bgParticles.classList.contains("active"),
        grid: bgGrid.classList.contains("active"),
        aurora: bgAurora.classList.contains("active"),
        neonCursor: document.body.classList.contains("neon-cursor-on")
      };
      localStorage.setItem("vulWidgetState", JSON.stringify(state));
    }

    function loadState() {
      const raw = localStorage.getItem("vulWidgetState");
      if (!raw) return;
      try {
        const state = JSON.parse(raw);
        if (state.hue) {
          root.style.setProperty("--hue", state.hue);
          root.style.setProperty("--glow", `hsl(${state.hue}, 100%, 50%)`);
          colorSlider.value = parseInt(state.hue, 10);
        }
        if (state.bgLightness) {
          root.style.setProperty("--bgLightness", state.bgLightness);
          bgSlider.value = parseInt(state.bgLightness, 10);
        }

        if (state.glass) widget.classList.add("glass");
        if (state.circuit) widget.classList.add("circuit");
        if (state.rainbowPage) document.body.classList.add("rainbow-page");
        if (state.holo) document.body.classList.add("holo-on");
        if (state.particles) bgParticles.classList.add("active");
        if (state.grid) bgGrid.classList.add("active");
        if (state.aurora) bgAurora.classList.add("active");
        if (state.neonCursor) document.body.classList.add("neon-cursor-on");

        chkGlass.checked = !!state.glass;
        chkCircuit.checked = !!state.circuit;
        chkRainbowPage.checked = !!state.rainbowPage;
        chkHolo.checked = !!state.holo;
        chkParticles.checked = !!state.particles;
        chkGrid.checked = !!state.grid;
        chkAurora.checked = !!state.aurora;
        chkNeonCursor.checked = !!state.neonCursor;
      } catch (e) {
        console.warn("Failed to load state", e);
      }
    }

    loadState();
  </script>

</body>
</html>
